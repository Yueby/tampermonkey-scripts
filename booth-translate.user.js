// ==UserScript==
// @name         Booth 网站翻译助手
// @namespace    https://bbs.tampermonkey.net.cn/
// @version      0.1.0
// @description  自动翻译 Booth 网站的多语言内容为中文
// @author       You
// @match        https://*.booth.pm/*
// @grant        GM_xmlhttpRequest
// @grant        GM_addStyle
// @connect      translate.googleapis.com
// @run-at       document-idle
// ==/UserScript==

(function () {
    'use strict';

    // 配置类 - 集中管理所有配置
    class Config {
        // 基本配置
        static settings = {
            checkInterval: 600,    // 检查间隔（毫秒）
            maxChecks: 20,         // 最大检查次数
            throttleDelay: 100    // 节流延迟（毫秒）
        };

        // 基本翻译规则
        static translations = {
            // 商品分类标题
            'Categories': '商品分类',
            'Digital': '数字商品',

            // 主要分类
            'Comics': '漫画',
            // 漫画子分类
            'Manga': '单行本',
            '4-panel Comics': '四格漫画',

            // 插画
            'Illustration': '插画',
            // 插画子分类
            'Illustration & CG collections': '插画与CG合集',
            'Illustrations': '插画作品',
            'Tutorials': '教程',
            'Wallpapers': '壁纸',
            '3DCG': '3DCG',
            'Illustration (Other)': '其他插画',

            // 小说与书籍
            'Novels & Books': '小说与书籍',
            // 小说与书籍子分类
            'Light Novels': '轻小说',
            'Picture Books': '绘本',
            'Tech Books': '技术书籍',
            'Quiz': '问答集',
            'Criticism': '评论集',
            'Essays': '随笔',
            'Travel': '旅行',
            'History': '历史',
            'Cooking & Gourmet': '料理与美食',
            'Poetry & Haiku & Tanka': '诗歌与俳句和短歌',
            'Books (Other)': '其他书籍',

            // 周边商品
            'Goods': '周边商品',
            // 周边商品子分类
            'Acrylic Key Chain': '亚克力钥匙扣',
            'Key-holders & Straps': '钥匙扣和挂绳',
            'Can Badge': '徽章',
            'Badges': '徽章',
            'Stickers': '贴纸',
            'Postcards': '明信片',
            'Acrylic Figure': '亚克力人偶',
            'iPhone Cases': 'iPhone手机壳',
            'Smartphone Cases': '智能手机壳',
            'Body-pillow Covers': '抱枕套',
            'Stationery': '文具',
            'Tapestries': '挂毯',
            'Pouch': '收纳袋',
            'Masking Tape': '和纸胶带',
            'Glasses & Mugs': '杯子',
            'Eyeglass cleaning cloths': '眼镜布',
            'Commuter pass': '通勤证件套',
            'Towels': '毛巾',
            'Mobile Batteries': '移动电源',
            'clear_file_folder': '透明文件夹',
            'Pin Badge': '别针徽章',
            'Posters': '海报',
            'Blankets': '毛毯',
            'Ring Grip': '手机指环扣',
            'Acrylic Block': '亚克力摆件',
            'Acrylic Badge': '亚克力徽章',
            'Calendars': '日历',
            'Mirrors': '镜子',
            'Cushions & Covers': '靠垫和套',
            'Card cases': '卡片盒',
            'Coasters': '杯垫',
            'Laminated Cards': '层压卡片',
            'Pen Case': '笔袋',
            'Smartphone Stand': '手机支架',
            'Mousepad': '鼠标垫',
            'Puzzle': '拼图',
            'Clocks': '时钟',
            'Pillow Cover': '枕套',
            'Seal Case': '印章盒',
            'Stamping Mat': '印章垫',
            'Pencil Board': '垫板',
            'Umbrella': '雨伞',
            'Mini Tabletop Umbrella': '迷你桌面伞',
            'Goods (Other)': '其他周边',

            // 服饰
            'Fashion': '服饰',

            // 配饰
            'Accessories': '配饰',

            // 3D模型
            '3D Models': '3D模型',
            // 3D模型子分类
            '3D Characters': '3D角色',
            '3D Clothing': '3D服装',
            '3D Accessories': '3D配饰',
            '3D Props': '3D道具',
            '3D Textures': '3D贴图',
            '3D Tools & Systems': '3D工具和系统',
            '3D Motion & Animation': '3D动作和动画',
            '3D Environments / World': '3D环境/场景',
            'VRoid': 'VRoid',
            '3D Models (Other)': '其他3D模型',

            // 音乐
            'Music': '音乐',
            // 音乐子分类
            'Music (General)': '一般音乐',
            'Vocaloid': 'Vocaloid',
            'Game Music': '游戏音乐',
            'Music (Other)': '其他音乐',

            // 音频商品
            'Audio Goods': '音频商品',

            // 游戏
            'Games': '游戏',
            // 游戏子分类
            'Computer Games': '电脑游戏',
            'Tabletop Games': '桌面游戏',
            'Tabletop RPG': '桌面角色扮演游戏',
            'Game-related Items': '游戏相关物品',

            // 软件与硬件
            'Software & Hardware': '软件与硬件',
            'Software': '软件',
            'Hardware & Gadget': '硬件与设备',

            // 素材
            'Source Materials': '素材',
            'Graphics': '图形素材',
            'Graphics (3D)': '3D图形素材',
            'Background Images': '背景图片',
            'Fonts': '字体',
            'Icons': '图标',
            'Logos': '标志',
            'Background Music': '背景音乐',
            'Sound Effects': '音效',
            'Materials (Other)': '其他素材',

            // 视频
            'Video': '视频',
            'Animation': '动画',
            'Live-action works': '实拍作品',

            // 摄影
            'Photographs': '摄影',
            'Photos': '照片',
            'Photobooks': '写真集',

            // Cosplay
            'Cosplay': 'Cosplay',
            // Cosplay 子分类
            'Cosplay Photos': 'Cosplay 照片',
            'Cosplay CDs': 'Cosplay CD',
            'Cosplay Outfits': 'Cosplay 服装',
            'Cosplay Accessories': 'Cosplay 配饰',
            'Cosplay Videos': 'Cosplay 视频',
            'Cosplay (Other)': '其他 Cosplay',

            // 艺术
            'Arts': '艺术',
            'Art': '艺术',
            // 艺术子分类
            'Primo Art': '原创艺术',
            'Crafts': '手工艺品',
            'Sculptures, objects': '雕塑与物件',
            'Woodcuts': '木刻',
            'Folding screen': '折屏',
            'Paintings, artworks (other)': '绘画与其他艺术品',

            // 管理菜单项
            'Manage Shop': '管理店铺',
            'Manage Items': '管理商品',
            'Warehouse Service': '仓储服务',
            'Sales': '销售情况',
            'Messages List': '消息列表',

            '注文一覧': '订单列表',

            // 关注按钮
            'フォロー': '关注',
            'Follow': '关注',
            'フォロー中': '已关注',
            'Following': '已关注',

            // 公告
            'Announcement': '公告',
            'お知らせ': '公告',

            // 搜索框
            'キーワードを入力': '请输入关键词',
            'Enter keywords': '请输入关键词',
            '検索': '搜索',
            'Search': '搜索',

            // 筛选相关
            '絞り込み': '筛选',
            '最近の検索': '最近搜索',
            '検索履歴はありません': '无搜索历史',
            '検索履歴をクリア': '清除搜索历史',
            'キーワード': '关键词',
            '除外キーワード': '排除关键词',
            '除外したいキーワードを入力': '请输入要排除的关键词',
            '入力されたキーワードを含む商品を検索結果から省きます。': '搜索结果将排除包含输入关键词的商品。',
            'タグ': '标签',
            'タグを入力(ジャンルなど)': '请输入标签（如类型等）',
            '入力されたタグをすべて含む商品のみ検索結果に表示されます。': '搜索结果将只显示包含所有输入标签的商品。',
            'サブカテゴリ': '子分类',
            'イベント': '活动',
            '商品タイプ': '商品类型',
            '年齢制限': '年龄限制',
            'その他': '其他',
            '価格': '价格',

            // 商品类型
            '実物商品': '实物商品',
            '実物商品（自家発送）': '实物商品（从自家发送）',
            'ダウンロード商品': '下载商品',
            '実物商品（倉庫発送）': '实物商品（从仓库发送）',
            '実物商品（pixivFACTORY発送）': '实物商品（从pixivFACTORY发送）',

            // 年龄限制
            'R18限定': 'R18限定',
            '全年齢限定': '全年龄限定',

            // 其他选项
            '販売終了した商品を表示': '显示已售完及贩售结束的商品',
            '最近公開された商品のみ': '最近公开的商品限定',

            // 按钮
            '条件をクリア': '清除条件',
            '絞り込む': '筛选',

            // 无指定选项
            '指定なし': '无指定',
            'default': '无指定',

            // 消息通知
            'さんよりメッセージが届いています': ' 发来了消息',
            'よりメッセージが届いています': ' 发来了消息',
            'メッセージが届いています': ' 发来了消息',

            // 消息表单
            'ニックネームがショップに伝わります。': '您的昵称将会传达给店铺。',
            'Input message': '请输入消息',

            // 消息表单
            'メッセージを入力': '请输入消息',
            'ショップオーナーのメールアドレスが相手に伝わることはありません': '店主的邮箱地址不会被传达给对方',

            // 用户信息
            'Identification Code': '识别码',
            'メッセージを一斉送信する': '群发消息',

            'Age Restriction': '年龄限制',
            'Reset': '重置',

            // 店铺设置
            'Shop Base Information': '店铺基本信息',
            'Shipping Costs': '运费设置',
            'Payout Settings': '支付设置',
            'Seller Information': '卖家信息',
            '基于特定商取引法的表示': '特定商业交易法相关说明',
            'About Tenant Inforamation': '关于租户信息',
            'Taxable Profile': '税务资料',
            'Open/Close': '公开/私密',

            // 店铺基本信息
            'Description': '描述',
            'Subdomain': '子域名',
            'Website': '网站',
            'Google Analytics Measurement ID': 'Google Analytics 跟踪 ID',
            '取得/管理されているサブドメインに変更したい場合には？': '如何修改已获取/管理的子域名？',

            // 支付设置
            'お支払い方法': '支付方式',
            '注文後すぐに支払済みになるお支払い方法のみを許可する': '仅允许下单后立即完成支付的支付方式',
            'ONにすると、購入者は「銀行・コンビニ決済」での注文ができなくなります。': '开启后，买家将无法使用"银行/便利店支付"进行订购。',
            '銀行・コンビニ決済の3日間の支払い期限が待てない場合や、未払いによるキャンセルがショップ管理に支障をきたす場合などにご使用ください。': '如果无法等待银行/便利店支付的3天支付期限，或者因未付款导致的取消会影响店铺管理时，请使用此选项。',

            // 收款设置
            '収益額の収款账户': '收益额的收款账户',
            'Payout Method': '收款方式',
            'Email Address': '邮箱地址',
            'Bank account': '银行账户',
            '设定收款账户': '设置收款账户',
            'PayPalについて': '关于 PayPal',
            'Identity verification through PayPal is required for payments (withdrawals) of over 100,000 JPY.': 'PayPal 支付（提现）超过 100,000 日元时需要进行身份验证。',
            '如收款账户资料有误，有可能无法进行销售额汇款。': '如收款账户资料有误，有可能无法进行销售额汇款。',

            // 购买者留言
            '購入者へのひとこと': '给买家的留言',
            'メッセージは注文完了時の画面に表示されます。': '留言将在订单完成时显示。',
            '空白の場合メッセージは表示されません。': '如果留空则不显示留言。',
            '例）「ご注文ありがとうございました！！」など（最大50文字）': '例如："感谢您的订购！！"等（最多50字）',

            // 店铺操作
            'Delete Shop': '删除店铺',
            'Close': '关闭',
            'Destroy': '删除',

            // 卖家信息
            'BOOTHでの商品販売にあたり、実際に商品の発送を行う住所、返送商品の受け取りが可能な住所をご登録ください。': '请登记实际发货地址和可接收退货的地址。',
            'また、ご登録いただいた情報に変更がある場合、登録情報の修正をお願いいたします。': '如果登记的信息有变更，请及时修改登记信息。',
            'ご登録いただいた情報は主に以下の用途に利用されます。': '登记的信息主要用于以下用途：',
            'あんしんBOOTHパックの送料計算': '安心BOOTH包裹的运费计算',
            'BOOTH倉庫サービスで保管している商品の返送先': 'BOOTH仓库服务保管商品的退货地址',
            '※ご登録いただいた情報は他ユーザーに開示されません。': '※登记的信息不会向其他用户公开。',
            'e.g. John Smith': '例如：张三',
            '本名をご記入ください（30文字以内。': '请填写真实姓名（30字以内。',
            'ニックネーム不可': '不可使用昵称',
            'Country': '国家/地区',
            'State / Province / Region / Prefecture': '省/州/地区',
            'e.g. 1234567': '例如：410000',
            '都道府县': '省份',
            '市区町村、丁目、番地': '市区街道地址',
            'e.g. City, town, village / District numbers': '例如：市区街道门牌号',
            '要记得填写丁目和番地哦': '请填写详细地址',
            'e.g. 09012341234': '例如：13812345678',
            'SMS notification feature is only available in Japan': 'SMS通知功能仅在日本可用',
            'More about SMS notification': '更多关于SMS通知的信息',
            'Do NOT input country code (+1, +86, etc...)': '请勿输入国家代码（如+1、+86等）',
            'The items which use Japan-only options (あんしんBOOTHパック, シークレット公開) will be private.': '使用日本专属选项（安心BOOTH包裹、私密发布）的商品将被设为私密。',
            'Save': '保存',

            // 特定商业交易法
            'Notation on specific trade law': '特定商业交易法说明',
            'it is necessary notation matter by the Ministry of Economy,': '这是经济产业省规定的必要标注事项，',
            'Trade and Industry when you carry out the business on the INternet.': '适用于在互联网上开展业务时。',
            'If you are retailers, please notate your seller information in below terms.': '如果您是零售商，请在以下条款中注明您的卖家信息。',
            'Name / Contact Information': '名称/联系方式',
            'About Price': '关于价格',
            'Extra Cost Information': '额外费用信息',
            'Payment Method Information': '支付方式信息',
            'Payment Due date Information': '付款期限信息',
            'Shipping Information': '配送信息',
            'Returning Method Information': '退货方式信息',
            'Notes': '备注',
            'BOOTH Name': 'BOOTH 店铺名',
            'To change your BOOTH name, visit the BOOTH design page.': '要更改您的 BOOTH 店铺名，请访问 BOOTH 设计页面。',
            'You must fill your e-mail address in this form so that users can contact with you.': '您必须在此表单中填写电子邮件地址，以便用户能够与您联系。',
            '省略した記載については、電子メール等の請求により遅滞なく開示いたします。': '对于省略的信息，将根据电子邮件等请求及时披露。',
            '販売价格は、消費税を含む价格で表示されています。': '销售价格已包含消费税。',
            '配送料は、別途ご負担いただきます。': '配送费用需要另行支付。',
            '発送方法・サイズ等により料金が異なります。': '费用根据发货方式和尺寸等而异。',
            '各決済画面にてご確認ください。': '请在各支付页面确认。',
            '倉庫から発送（宅配便またはネコポス）': '从仓库发货（快递或猫宅急便）',
            '※全国一律': '※全国统一价',
            '自宅から発送（あんしんBOOTHパック）': '从自家发货（安心BOOTH包裹）',
            '※配送元・配送先・サイズにより料金が異なります': '※费用根据发货地、收货地和尺寸而异',
            '自宅から発送（あんしんBOOTHパック以外）': '从自家发货（安心BOOTH包裹以外）',
            '配送料はオーナーの設定により0〜1万円かかります': '配送费用根据店主设置在0~10000日元之间',
            'ダウンロード商品': '下载商品',
            '配送料はかかりません': '无需配送费',
            'pixivFACTORYから発送': '从pixivFACTORY发货',
            // 支付方式
            'pixivcoban': 'pixivcoban',
            'ピクシブかんたん決済': 'pixiv简单支付',
            'PayPal決済': 'PayPal支付',
            'クレジットカード決済': '信用卡支付',
            '楽天ペイ': '乐天支付',
            '銀行決済': '银行支付',
            'コンビニ決済': '便利店支付',
            '商品注文時点でお支払いが確定します。': '下单时即确定支付。',
            'ご注文後お支払い番号を公告しますので、お支払い番号の発行日の翌日から3日以内に代金をお支払いください。': '下单后我们会通知您支付号码，请在支付号码发行日的次日起3天内完成支付。',
            'ご注文後お支払い番号を公告しますので': '下单后我们会通知您支付号码，',
            'お支払い番号の発行日の翌日から3日以内に代金をお支払いください': '请在支付号码发行日的次日起3天内完成支付',
            '自宅から発送：支払確認後、7日以内に発送いたします。': '从自家发货：确认付款后7天内发货。',
            'To change days to ship, visit the 店铺基本信息.': '要更改发货天数，请访问店铺基本信息。',
            '商品に欠陥が認められた場合を除き、返品には応じません。': '除商品有缺陷外，不接受退货。',

            // 法人用户说明
            'BOOTHをご利用いただくにあたり法人のお客様は、販売者情報をご登録いただく必要がございます。': '法人客户在使用BOOTH时，需要注册卖家信息。',
            'ご登録いただいた情報は、決済代行業者で実施される「信用卡支付を伴うお取引の可否」の審査に使用されます。': '注册的信息将用于支付代理商进行的"是否允许信用卡支付交易"的审查。',
            'それ以外の用途には一切使用いたしませんのでご安心ください。': '请放心，这些信息不会用于其他任何用途。',
            'ご登録いただけない場合、一部決済方法がご利用いただけなくなる可能性もございます。': '如果不注册，可能无法使用部分支付方式。',
            'ご登録いただいた情報に変更がある場合、登録情報の修正をお願いいたします。': '如果注册的信息有变更，请修改注册信息。',

            // 租户类型
            '種別': '类型',
            '個人': '个人',

            // 税务资料
            '事業者情報について': '关于经营者信息',
            'このフォームから、ショップへの注文に対してインボイス（適格請求書）として利用できる領収書を発行するための、事業者情報を登録できます。': '通过此表单，您可以注册经营者信息，用于为店铺订单发行可作为发票（合格请求书）使用的收据。',
            'ショップへの注文の領収書を購入者に発行したい場合、次の条件・各入力欄の説明をよく読んで、事業者情報を登録してください。': '如果您想为购买者发行店铺订单的收据，请仔细阅读以下条件和各输入栏的说明，然后注册经营者信息。',
            'ショップオーナーは、購入者に発行した領収書の写しをダウンロードできます。領収書の写しは法定年数の保存が義務付けられています。': '店主可以下载发给购买者的收据副本。收据副本必须保存法定年限。',
            'BOOTHで発行される領収書は標準税率のみに対応しております。': 'BOOTH发行的收据仅支持标准税率。',
            '軽減税率の商品も標準税率で発行されるため、軽減税率の商品を扱うショップにおける領収書は購入者からの問い合わせに応じてショップオーナーで作成、交付してください。': '由于减税商品也按标准税率开具，对于经营减税商品的店铺，请店主根据购买者的要求制作和发放收据。',
            '（ショップオーナーにて交付する場合、インボイス制度の媒介者交付特例は適用できないためショップオーナーの登録番号等をご利用ください。）': '（如果由店主发放，由于不适用发票制度的中介者发放特例，请使用店主的注册号等。）',
            '失効年月日は事業者情報の初期設定後に登録できるようになり、その日付以降の注文は領収書を発行できなくなります。': '失效日期可在经营者信息初始设置后注册，该日期之后的订单将无法发行收据。',
            'インボイス発行事業者の登録が失効する際は、失効年月日の登録をお願いいたします。': '当发票发行经营者的注册失效时，请注册失效日期。',

            // 表单字段
            'Registration Number': '注册号',
            'T + 13 digits': 'T + 13位数字',
            '登録番号はインボイス発行事業者の登録通知に記載されています。': '注册号记载在发票发行经营者的注册通知中。',
            '媒介者交付特例を適用しない場合、この登録番号が領収書に記載されます。': '如果不适用中介者发放特例，此注册号将记载在收据上。',
            'Issuer Name': '发行人名称',
            'XX Corporation': 'XX公司',
            '氏名または名称はインボイス発行事業者の登録通知に記載されています。': '姓名或名称记载在发票发行经营者的注册通知中。',
            '媒介者交付特例を適用しない場合、この氏名または名称が領収書に記載されます。': '如果不适用中介者发放特例，此姓名或名称将记载在收据上。',
            'Registration Number Starts On': '注册号生效日期',
            'registration number': '注册号',
            '登録年月日はインボイス発行事業者の登録通知に記載されています。': '注册日期记载在发票发行经营者的注册通知中。',
            '領収書は登録年月日以降の注文で発行されます。': '收据将在注册日期之后的订单中发行。',
            'Use Intermediary Deliver Special Case': '使用中介者发放特例',
            'Use': '使用',
            'User': '用户',
            'Not use': '不使用',
            '媒介者交付特例を適用することで、ショップオーナーに代わって、ピクシブ株式会社の名称と登録番号が記載された領収書を発行します。': '通过适用中介者发放特例，将代替店主发行记载有Pixiv株式会社名称和注册号的收据。',
            '媒介者交付特例を適用せず、事業者の登録番号等を領収書に記載したい場合、BOOTH事務局にお問い合わせください。': '如果不适用中介者发放特例，想在收据上记载经营者的注册号等信息，请联系BOOTH事务局。',
            'Registration Number Expires On': '注册号失效日期',
            '失効年月日は事業者情報の登録後に設定でき、インボイス発行事業者の登録を取り消す際の「登録の効力を失う日」に該当します。': '失效日期可在注册经营者信息后设置，对应发票发行经营者注册取消时的"注册失效日期"。',
            '失効年月日の設定後、その日付以降に発生する注文は領収書が発行されなくなりますが、登録年月日から失効年月日の間の注文の領収書は取得できます。': '设置失效日期后，该日期之后发生的订单将无法发行收据，但可以获取注册日期到失效日期之间的订单收据。',
            'Register': '注册',
            'Expired 税务资料s': '已失效的税务资料',
            '失効した登録情報はありません': '没有已失效的注册信息',

            // 运费设置
            '送料設定': '运费设置',
            'About shipping costs': '关于运费',
            'Please confirm each delivery service by following links': '请通过以下链接确认各种配送服务',
            '定形外郵便': '非标准邮件',
            'スマートレター': 'Smart Letter',
            'クリックポスト': 'Click Post',
            'レターパック': 'Letter Pack',
            'Mail A（Whole of 国家/地区）': '邮寄 A（全国）',
            'Mail B（Whole of 国家/地区）': '邮寄 B（全国）',
            'Mail C（Whole of 国家/地区）': '邮寄 C（全国）',
            'Mail D（Whole of 国家/地区）': '邮寄 D（全国）',
            'About initial values of shipping cost': '关于运费的初始值',
            'Update Shipping Costs': '更新运费',

            // 商品管理
            'Add Item': '添加商品',
            '商品リスト管理': '商品列表管理',
            'All': '全部',
            'Draft': '草稿',
            'Public': '公开',
            'Private': '私密',

            // 管理界面
            'ギフトを発行する': '发行礼品',
            'Edit': '编辑',
            'Undispatched': '未发货',
            'Unpaid': '未付款',
            'Paid': '已付款',
            'Price': '价格',
            'Stock': '库存',
            'Sales': '销量',
            'Proceeds': '收益',
            'Adult': '成人',

            // 商品统计信息
            'Number of people who love it': '喜欢这个商品的人数',

            // 商品发布类型
            '自家通販がしたい': '我想自行销售',
            'デジタルデータを販売したい': '我想销售数字数据',
            '自分で商品を発送。': '自行发货商品。',
            'あんしんBOOTHパック': '安心BOOTH包裹',
            'なら匿名で配送できます。': '可以匿名配送。',
            '購入者にメッセージカードを添えたいときなどにオススメです。': '适合想给买家附赠留言卡片等情况。',
            '購入者は支払い後に注文履歴からダウンロードできます。': '买家付款后可以从订单历史记录中下载。',
            'サンプル・体験版などを無料公開もできます。': '也可以免费公开样品、试用版等。',
            '「自宅から発送」商品を登録': '注册"从自家发货"商品',
            '「ダウンロード」商品を登録': '注册"下载"商品',

            // 违规提示
            'See also:': '参见：',
            'Prohibited Items': '禁止商品',
            'Items Requiring Revision': '需要修改的商品',

            // BOOTH应用功能
            'シークレット公開': '私密发布',
            '容量追加': '容量升级',
            '商品ページへのURLと「合言葉」を知っているユーザーだけに商品を公開できる機能です。': '这是一个只向知道商品页面URL和"暗号"的用户公开商品的功能。',
            '即売会で頒布した作品にURLと合言葉を記載し、お礼の商品を限定公開できます。': '可以在展会发布的作品中附上URL和暗号，限定公开感谢商品。',
            '商品登録の際にアップロードできるファイルの総容量を増やすことができます。': '可以增加商品注册时可上传的文件总容量。',
            'ゲームや音楽などのサイズが大きいファイルをアップしたい方やたくさん商品データを保存して販売したい方にオススメです。': '推荐给想上传游戏、音乐等大文件，或想保存并销售大量商品数据的用户。',
            'シークレット公開をチェック': '查看私密发布',
            '容量追加をチェック': '查看容量升级',

            // 仓库发货和预售
            '発送を倉庫に任せたい': '想要委托仓库发货',
            '受注生産や予約販売がしたい': '想要接受定制或预售',
            '注文を受付けると倉庫から自動で発送されます。': '接收订单后将从仓库自动发货。',
            '特に在庫数が多いときにオススメです。': '特别推荐给库存量大的情况。',
            '倉庫への入荷を待たずに注文を受付けできます。': '无需等待仓库到货即可接受订单。',
            '注文数が確定してから生産を始めたり、': '可以在确定订单数量后开始生产，',
            'すぐに販売開始したい場合にオススメです。': '推荐给想要立即开始销售的情况。',
            '「倉庫から発送」商品を登録': '注册"从仓库发货"商品',
            '「倉庫から発送（後から入荷）」商品を登録': '注册"从仓库发货（后续到货）"商品',
            '倉庫サービスについて詳しく': '了解更多仓库服务',

            // 菜单和pixivFACTORY
            'おしながき': '商品菜单',
            '活动で頒布する作品の商品菜单を登録できます。': '可以登记在活动中分发的作品的商品菜单。',
            '活动終了後にBOOTHで頒布することもできます。': '活动结束后也可以在BOOTH上发布。',
            '「おしながき」を登録': '注册"商品菜单"',
            'グッズを簡単に作ってすぐ売りたい': '想要简单制作商品并立即销售',
            'pixivFACTORYはイラスト1枚からグッズを作れるサービス。': 'pixivFACTORY是一个可以用一张插画制作商品的服务。',
            '在庫を抱えることなく、1点から販売できます。': '无需库存，可以从1件开始销售。',
            'pixivFACTORYでグッズをつくる': '在pixivFACTORY制作商品',

            // 仓库相关提示
            '海外から商品を倉庫へ発送する際は、': '从海外发送商品到仓库时，',
            'ショップオーナー様ご自身で関税等の支払いをお済ませください。': '请店主自行支付关税等费用。',

            // 商品编辑页面
            'Pick a sales approach': '选择销售方式',
            'Edit Item': '编辑商品',
            '商品情報': '商品信息',
            '贩卖方法': '销售方式',
            'Name': '名称',
            'Nameを入力してください': '请输入名称',
            'Item image': '商品图片',
            '画像ファイルをドラッグ＆ドロップ': '拖放图片文件',
            'イメージ画像だけでなく「実物の写真」があると、購入されやすくなります。': '除了示意图，有"实物照片"会更容易售出。',
            '画像を追加': '添加图片',
            '第一张图片会作为商品列表的主视图使用': '第一张图片将作为商品列表的主图使用',
            'Category': '分类',
            '请选择类型': '请选择类型',
            'All Age': '全年龄',
            'Description': '描述',
            '规格（尺寸、素材、颜色、页数…）、制作过程、熟人写的推荐文章等等，从多个角度来介绍商品吧。': '规格（尺寸、材质、颜色、页数…）、制作过程、熟人写的推荐文章等等，从多个角度来介绍商品吧。',
            '「埋め込みコンテンツ」で': '使用"嵌入内容"功能',
            'を埋め込むと、一部ページの商品画像の先頭にも、そのYouTube動画が表示されます。': '嵌入后，该YouTube视频也会显示在部分页面的商品图片顶部。',
            '1.【動画】などは下の「埋め込みコンテンツ」で。\n\n2.【長文】は下の「段落」機能で。': '1.【视频】等请使用下方的"嵌入内容"功能。\n\n2.【长文本】请使用下方的"段落"功能。',
            '段落': '段落',
            '嵌入内容': '嵌入内容',
            '标签': '标签',
            'タグの追加': '添加标签',
            'Tags are used not only on keyword search but also on recommendation engines.': '标签不仅用于关键词搜索，还用于推荐系统。',
            'Please fill-in the field': '请填写此字段',
            'to make the item easier to be found': '以使商品更容易被找到',
            'Event': '活动',
            '选择活动名': '选择活动名',
            '若此商品曾在，或计划于即卖会等活动中推出，请务必设置此项目。': '若此商品曾在，或计划于即卖会等活动中推出，请务必设置此项目。',
            'Price': '价格',
            '日元': '日元',
            '作品文件': '作品文件',
            'ファイルの追加・管理': '添加和管理文件',
            'Sell out of Japan': '日本境外销售',
            'Show This Item on Oversea Shipping Services': '在海外配送服务上显示此商品',
            'Please select...': '请选择...',
            'Accepted': '接受',
            'Refused': '拒绝',
            '高级选项': '高级选项',
            '打开高级选项': '打开高级选项',
            '版本、限定贩卖数量': '版本、限定销售数量',
            '关闭高级选项': '关闭高级选项',
            'Variation': '版本',
            '可添加像S、M、L等版本': '可添加像S、M、L等版本',
            '添加版本': '添加版本',
            'Purchase Limit': '购买限制',
            '每人限购数量（0表示设定无效）': '每人限购数量（0表示设定无效）',
            'Shipping Date (Approx)': '预计发货日期',
            '想要「按订单生产」或「活动完结后开始发货」的时候请使用该功能。': '想要"按订单生产"或"活动结束后开始发货"时请使用该功能。',
            '会显示在买家的订单详情页面': '会显示在买家的订单详情页面',
            '请注意，如果在有未发货订单的状态下进行更改，则会显示更改后的预定发货日期。': '请注意，如果在有未发货订单的状态下进行更改，则会显示更改后的预定发货日期。',
            '期间限定贩卖': '限时销售',
            'Sell this item only during the event': '仅在活动期间销售此商品',
            '仅允许在活动举办期间加入购物车': '仅允许在活动举办期间加入购物车',
            '商品不会自动公开或隐藏，请自行设定公开与否。': '商品不会自动公开或隐藏，请自行设定公开与否。',
            '作品ファイルの無いダウンロード販売商品があります': '存在没有作品文件的下载商品',
            '请选择「类型」以进行公开': '请选择"类型"以进行公开',
            '请填写「商品简介」以进行公开': '请填写"商品简介"以进行公开',
            '进行发货地址（店主联络方式）登录后才能使用安心BOOTH包裹': '进行发货地址（店主联络方式）登录后才能使用安心BOOTH包裹',
            '关于商品上架的注意事项': '关于商品上架的注意事项',
            '商品禁止包含违反相关法律、条例、公共道德秩序，以及其他本公司的规定条款的内容。': '商品禁止包含违反相关法律、条例、公共道德秩序，以及其他本公司的规定条款的内容。',
            '（其中严禁触及实景真人、接近实景真人的写实表现、对儿童的性剥削与性虐待、近亲相奸、兽交、强奸（未经同意的性行为），以及对人体或躯体的非法切断等内容。）': '（其中严禁触及实景真人、接近实景真人的写实表现、对儿童的性剥削与性虐待、近亲相奸、兽交、强奸（未经同意的性行为），以及对人体或躯体的非法切断等内容。）',
            '下書きで保存する': '保存为草稿',
            '公開で保存する': '公开发布',
            'Delete this item': '删除此商品',

            // 服饰子分类
            'T-Shirts': 'T恤',
            'Parkas': '连帽衫',
            'sweatshirt': '卫衣',
            'Tote bags': '托特包',
            'Bags': '包包',
            'sacoche': '斜挎包',
            'Hats &  Caps': '帽子',
            'Tights': '紧身衣',
            'Fashion (Other)': '其他服饰',

            // 配饰子分类
            'Earrings': '耳环',
            'Necklaces': '项链',
            'Bracelets': '手链',
            'Hair Accessories': '发饰',
            'Brooches': '胸针',
            'Pendants': '吊坠',
            'Accessories (Other)': '其他配饰',

            // 手办与玩偶子分类
            'Figures': '手办',
            'Plushies': '毛绒玩具',
            'Dolls': '玩偶',

            // 音频商品子分类
            'Voices': '语音',
            'Drama CDs': '广播剧CD',
            'ASMR': 'ASMR',
            'Audio Goods (Other)': '其他音频商品',

            // 模态框相关
            'カテゴリを選択': '选择分类',

            // 3D角色和服务条款
            '3D角色用の推奨項目* を入力する': '输入3D角色的推荐项目*',
            'Terms of Service, update information...': '服务条款、更新信息...',

            // 销售方式选择
            '販売方法を選択してください': '请选择销售方式',
            'ダウンロード販売': '下载销售',

            // 文件管理模态框
            'ファイルの追加・管理': '添加和管理文件',
            'ファイル総容量が足りない時は、': '当文件总容量不足时，',
            '「容量追加」機能': '"容量升级"功能',
            'で総容量を100GBにできます。': '可以将总容量提升至100GB。',
            'アップロードできる1ファイルの容量制限は1GBです。': '单个文件上传大小限制为1GB。',
            'さらに詳しく': '了解更多',
            '購入者の約60%はスマホを利用しています。漫画などはZIPよりもPDFの方が喜ばれるようです。': '约60%的购买者使用手机。对于漫画等内容，PDF格式比ZIP格式更受欢迎。',
            'ファイルをドラッグ＆ドロップ': '拖放文件到此处',
            '対応形式:': '支持的格式：',

            // 其他分类
            'Other Categories': '其他分类',

            // 国际配送提示（分段翻译）
            'Read about \'日本境外销售\'': '了解"日本境外销售"',
            '作品ファイルの無いダウンロード販売商品があります': '存在没有作品文件的下载销售商品',
            'This selector enables to': '此选择器允许',
            'accept uploading the item information': '接受上传商品信息',
            'onto oversea shipping services\' web sites and applications': '到海外配送服务的网站和应用程序',
            'for shipping your item internationally': '用于国际配送您的商品',
            'Oversea shipping services': '海外配送服务',
            'may not show your item information': '可能不会显示您的商品信息',

            'if the items are download contents, have sensitive contents or any other reasons rely on the shipping services': '如果商品是下载内容，包含敏感内容，或由于配送服务的其他原因',

            // 拆分成更小的片段
            'if the items are download contents': '如果商品是下载内容',
            'have sensitive contents ': '包含敏感内容',
            'any other reasons rely on the shipping services': '由于配送服务的其他原因',
            'download contents': '下载内容',
            'sensitive contents': '敏感内容',

            'and': '和',
            'and the ': '并且',

            // 拆分配送地址相关文本

            'warehouses of the oversea shipping services': '海外配送服务的仓库',
            'shipping services will ship them internationally': '配送服务会将其国际配送',
            'You should ship the items to the Japanese address': '您需要将商品发送到日本地址',

            // 添加新的翻译规则
            '商品の公開後、一部の決済手段についてはBOOTH事務局による審査後に初めて利用可能となります。': '商品发布后，部分支付方式需要经过BOOTH事务局审核后才能使用。',

            '審査の結果、一部の決済手段をご利用いただけない場合': '根据审核结果，可能无法使用某些支付方式',

            'また': '并且',

            'がございます。': '的情况。',

            '【注意】二次創作作品のライセンス許諾を受けた販売について': '【注意】关于获得二次创作作品许可的销售',
            '東方Project': '东方Project',
            '東北ずん子・ずんだもんプロジェクト': '东北俊子・俊达萌项目',
            'TRPG SPLL': 'TRPG SPLL',
            'などに関する商品は': '等作品的商品',
            '専用标签を設定するなどの所定の登録方法を行うことで販売が可能です': '通过设置专用标签等规定的注册方式即可销售',
            '該当作品を販売したい方は、こちらをお読みください。': '如果你想销售这些作品，请阅读这里。',
            'Listing Orders': '订单列表',
            'Completed': '已完成',
            'Cancelled': '已取消',
            'with Qualified Invoices': '含合格发票',
            'Direct': '直接发货',
            'Via warehouse': '通过仓库',
            'pixivFACTORY (On Demand)': 'pixivFACTORY (按需)',
            'Order ID': '订单编号',
            'Total': '总计',
            'Identification Code': '识别码',
            'Created At': '创建时间',
            'Paid At': '支付时间',
            'Completed At': '完成时间',
            '宛名印刷用CSV': '地址打印用CSV',

            // 订单和销售管理
            'Order Details': '订单详情',
            '売上管理CSVを発行する': '生成销售管理CSV',
            '総売上': '总销售额',
            '※ショップ開設から現時点までに発送完了となった注文の小計 + 各送料': '※从店铺开设至今已完成发货的订单小计 + 各项运费',
            '総売上の内訳を開く': '展开总销售额明细',

            // 收益相关
            '领取的金额': '领取的金额',
            'の収益額': '的收益额',

            // 银行转账相关
            '※銀行振込の場合、振込手数料が引かれた金額が入金されます。': '※银行转账时，将扣除手续费后的金额入账。',
            '振込手数料について': '关于转账手续费',
            '売上について': '关于销售额',
            '月末までに発送完了になっている注文が翌月の1日より売上の振込対象となります。': '月底前完成发货的订单将从下月1日起成为销售额转账对象。',
            '振込みについて': '关于转账',
            '受取金額の合計': '收款金额合计',
            '201円以上5,000円未満': '201日元以上5,000日元以下',
            '本画面に表示される「振込申請」ボタンから申請ください。': '请通过本页面显示的"申请转账"按钮进行申请。',
            '5,000円以上': '5,000日元以上',
            '自動振込みとなりますのでそのままお待ちください。': '将自动转账，请耐心等待。',
            '※銀行振込かつ受取金額が100万円以上の場合、振込みは振込を実行する月の第1営業日時点で登録されている振込先に行われます。': '※如果是银行转账且收款金额在100万日元以上，转账将在执行转账月份的第一个工作日，转入当时登记的收款账户。',

            // 其他
            'Share fixed date': '分成确定日期',

            // 收据相关
            '領収書': '收据',
            '発行済みの領収書': '已发行的收据',
            '発行済みの領収書はありません。': '没有已发行的收据。',
            'Details': '详细信息',
            'Share': '分成',
            'Fee': '费用',

            // 表格相关
            'Name': '名称',
            'Variation': '版本',
            'Quantity': '数量',
            'BOOST': '加成',
            'Subtotal': '小计',
            '已完成发货的金额': '已完成发货的金额',

            // BOOTH Apps 相关
            'BOOTH Appsは、ショップをよりパワーアップさせるための便利な機能拡張サービスです。': 'BOOTH Apps 是一项可以让您的店铺更加强大的便利功能扩展服务。',
            'ショップを充実させる機能追加や、新しい販促機能がご利用いただけます。': '您可以使用丰富店铺功能的附加功能和新的促销功能。',
            '詳しくはこちら': '了解更多',

            // 消息群发
            'メッセージ一斉送信': '消息群发',
            'フォロワーもしくは特定の商品の購入者に対してメッセージを一斉送信できる機能です。': '可以向关注者或特定商品的购买者群发消息的功能。',

            // 销售期间设置
            '販売期間設定': '销售期间设置',
            '商品に対して販売開始・販売終了日時の設定ができる機能です。': '可以为商品设置销售开始和结束时间的功能。',

            // 容量和存储
            'ファイル総容量が10GBから100GBとなります。': '文件总容量从10GB增加到100GB。',

            // 私密发布
            '特定のユーザーに商品を公開できる機能です。': '可以向特定用户公开商品的功能。',

            // 价格相关
            '/月': '/月',

            // 其他文本
            'BOOTH Appsはまだ生まれたばかり': 'BOOTH Apps 刚刚诞生。',
            '創作活動が楽しくなるようなAppsを': '我们将继续开发让创作活动更加有趣的应用',
            'どんどん開発していきます。': '。',
            '期待してお待ちください！': '敬请期待！',

            // 店铺相关
            'のショップ': '的店铺',
            'Recommended Shops': '推荐店铺',
            'Show All': '显示全部',

            // 购买历史相关
            'Purchase History': '购买历史',
            'Show Library': '显示库',
            'キーワード': '关键词',
            '全ての注文': '所有订单',
            '注文日時が新しい順': '按订单时间最新排序',
            // 订单状态和排序
            '支払待ち': '待付款',
            '支払済み': '已付款',
            '発送完了': '已发货',
            'キャンセル': '已取消',
            '注文日時が古い順': '按订单时间最早排序',
            '取消': '取消',
            'ago': '前',

            // 库相关
            'Library': '资料库',
            'Bought Items': '已购项目',
            'Gift': '礼物',

            // 愿望单相关
            'スキの管理': '愿望单管理',
            '新しいスキリストを作成': '创建新愿望单',
            'すべて': '全部',
            '未分類': '未分类',

            // 愿望单创建页面
            '新しいスキリストを作成': '创建新愿望单',
            'リスト名': '列表名称',
            '公開状態': '公开状态',
            '公開する': '公开',
            'リストの概要': '列表概要',
            '作成する': '创建',
            '公開されたスキリストは、SNSへのシェアなどにより検索エンジンやショップのGoogleアナリティクスから確認できる場合があります。': '已公开的愿望单可能会通过社交媒体分享等方式被搜索引擎或商店的Google Analytics查看。',

            // 通知标签
            'Notice': '通知',

            // 店铺设计相关
            'ヘッダー画像': '页眉图片',
            '画像サイズ 1500px x 500px推奨': '建议图片尺寸 1500px x 500px',
            'ヘッダー画像はアップロード後、すぐに反映されます。': '页眉图片上传后将立即生效。',
            '画像をアップロード': '上传图片',
            '画像の削除': '删除图片',
            'ショップ名を重ねて表示する': '显示店铺名称',
            'ショップ(ヘッダー部分)にショップ名を表示するかを選択できます。': '可以选择是否在店铺（页眉部分）显示店铺名称。',

            // 主题颜色相关
            'テーマカラー': '主题颜色',
            'ショップ背景': '店铺背景',
            'コンテンツ背景': '内容背景',
            '枠線': '边框',
            'テキストカラー': '文字颜色',
            '商品価格': '商品价格',
            '強調色': '强调色',
            'リンクカラー': '链接颜色',

            // 背景图片相关
            'ショップ背景画像': '店铺背景图片',
            'ショップ背景画像はアップロード後、すぐに反映されます。': '店铺背景图片上传后将立即生效。',
            '繰り返し': '重复',
            '繰り返す': '重复',
            '横方向に繰り返す': '水平重复',
            '縦方向に繰り返す': '垂直重复',
            '繰り返さない': '不重复',
            '位置の固定': '位置固定',
            '固定': '固定',
            'スクロール': '滚动',
            '横方向の位置': '水平位置',
            '左端': '左侧',
            '中央': '中间',
            '右端': '右侧',
            '縦方向の位置': '垂直位置',
            '上端': '顶部',
            '下端': '底部',

            // 按钮
            '更新する': '更新',

            // 礼物相关
            'Issue Gift': '发送礼物',
            'Edit This Item': '编辑此商品',
            'Buy a Gift': '购买礼物',

            // 礼物管理相关
            'すべてのギフト管理': '所有礼物管理',
            '商品のギフト管理': '商品礼物管理',
            'ギフトを発行する': '发行礼物',
            'バリエーションを選択': '选择商品规格',
            'メモ': '备注',
            '例) @booth_pmさん宛': '例如) 发给 @booth_pm',
            'メモは自分用の自由入力欄です。ギフトを渡す相手には表示されません。': '备注是供自己使用的自由输入栏，不会显示给收礼物的人。',
            '発行件数': '发行数量',
            'ショップ全体で残り48件まで発行できます': '整个商店还可以发行48件',
            'すべてのバリエーション': '所有规格',
            'ギフトを渡す': '赠送礼物',
            '発行日時': '发行时间',
            '受取日時': '接收时间',
            '受取ユーザー': '接收用户',
            'ギフトについてよくある質問': '关于礼物的常见问题',
            '編集': '编辑',

            // 礼物相关
            'ギフトID': '礼物ID',
            'You published this gift.': '您发布了这个礼物。',
            'Gift published on': '礼物发布于',
            'メモを保存': '保存备注',
            'Published At': '发布时间',
            'Accepted At': '接受时间',
            'State': '状态',
            'Accepted': '已接受',

            // 购物车相关
            'Items in cart': '购物车商品',
            'Check out via Buyee for shipping physical items to worldwide. To add items to your Buyee cart, use Add to Buyee Cart button on each product detail page.': '通过Buyee结账可将实物商品运送到全球。要将商品添加到Buyee购物车，请在每个商品详情页面使用"添加到Buyee购物车"按钮。',
            'Digital items can be checked out via BOOTH.': '数字商品可以通过BOOTH直接结账。',
            'Check your Buyee Cart': '查看Buyee购物车',

            // 购物提示
            '未成年の方は、親権者または後見人の承諾を得た上で購入するものとします。': '未成年人购买时需要获得父母或监护人的同意。',
            'カートに入れた段階では在庫は確保されません。注文完了前に在庫がなくなった場合や商品が非公開になった場合などは、商品を購入できなくなります。': '将商品加入购物车时不会保留库存。如果在订单完成前库存售罄或商品变为非公开，将无法购买商品。',
            '注文が正常に完了しているかどうかは、購入履歴をご確認ください。': '请查看购买历史以确认订单是否正常完成。',

            // 商品列表相关
            '商品リスト一覧': '商品列表一览',
            '新しいリストをつくる': '创建新列表',
            '追加': '添加',
            '作成済みのリストを編集する': '编辑已创建的列表',
            '公開中': '公开中',
            '編集する': '编辑',
            '商品を追加する': '添加商品',
            'リスト内の商品': '列表内的商品',
            '商品の追加・削除・順序変更は、即時反映されます': '商品的添加、删除、顺序更改将立即生效',
            '商品リストを削除': '删除商品列表',
            'Are you sure?': '确定吗？',

            // 商品列表相关
            '商品リスト': '商品列表',
            'を編集': '编辑',

            // 商品添加相关
            '添加する商品を選択する': '选择要添加的商品',
            '商品名が設定されていません': '未设置商品名称',

            // 最近浏览相关
            'Your Recently Viewed Items': '最近浏览的商品',
            'Clear History': '清除历史记录',

            // 下拉菜单翻译
            'フォロー新着商品': '关注新商品',
            'フォロー中のショップ': '已关注的店铺',
            '購入履歴': '购买记录',
            'ライブラリ': '资料库',
            'ショップとのメッセージ': '店铺消息',
            'ショップ管理': '店铺管理',
            '商品管理': '商品管理',
            '倉庫サービス': '仓库服务',
            '注文一覧': '订单列表',
            '売上管理': '销售管理',
            'ユーザーとのメッセージ': '用户消息',
            'BOOTH Apps': 'BOOTH 应用',
            'アカウント設定': '账号设置',
            '通知設定': '通知设置',
            'ログアウト': '退出登录',

            'Cancel': '取消',

            'Genre, Item 名称, etc.': '类型、商品名称等',

            // 订单详情相关
            'Order detail': '订单详情',
            'Order Number': '订单编号',
            'Customer Information': '客户信息',
            'Contact Customer': '联系客户',
            '購入者の订单列表': '买家订单列表',
            'Order Summary': '订单摘要',
            'Payment Amount': '支付金额',
            'Payment 费用': '支付手续费',
            '支払方式': '支付方式',
            '信用卡': '信用卡',

            // 价格相关
            '小计': '小计',
            '总计 価格': '总计金额',
            '総計': '总计',
            '費用': '费用',

            // 其他信息
            '識別コード': '识别码',
            'の注文': '的订单',  // 例如: "xxx の注文" 会变成 "xxx 的订单"
        };

        // 特殊翻译规则 - 为特定选择器添加额外文本
        static specialRules = {
            '.stock-count': {
                append: ' 件'      // 在库存数后添加"件"
            },

            '.categories-heading': {
                append: ' '  // 如果包含"详细分类"则添加空格
            },

        };

        static selectors = {
            // 静态内容选择器
            static: [
                // 图标和提示文本
                'i[title]',
                '[title]',
                // 标题和分类
                '.market_section-head-title',
                '.categories-menu .name',
                '.categories-heading',
                '.categories-list .nav-reverse',
                '.sub-categories .nav-reverse',
                '.panel-head',
                '.category-group',
                '.radio-label__inner',
                // 描述文本
                '.item-type-nav-description',
                '.item-type-nav-heading',
                // 按钮和链接
                'input[type="submit"].btn',
                'input.btn[type="submit"]',
                '.btn[type="submit"]',
                'a.btn',

                // 文本内容
                '.font-bold',
                '.checkbox_label__inner',
                '.font-default-family',
                '.u-tpg-caption1',
                '.u-tpg-label',
                '.typography-14',
                '.booth-dip-switch__label',
                '.link-ext',  // 添加外部链接选择器
                '.radio-label__inner',  // 添加单选标签选择器
                '[wrapper_tag]',  // 添加带有 wrapper_tag 属性的元素选择器
                '.u-w-75',  // 添加宽度类选择器
                '.u-w-sp-100',  // 添加响应式宽度类选择器
                'div.u-w-75.u-w-sp-100',  // 添加更具体的选择器用于处理包含换行的文本块
                '.u-w-75 *',  // 添加选择器以匹配 .u-w-75 内的所有元素
                // 管理界面
                '.cmd-label',
                '.data-heading',
                '.badge',
                // 通用元素
                'h1', 'h2', 'h3', 'h4', 'h5',
                'a', 'button', 'option',
                // 管理菜单
                'a[aria-label]',
                '.callout__body',
                // 新添加的选择器
                '.u-text-center',
                '.u-tpg-label',
                '.u-align-middle',  // 添加对齐类选择器
                'li',
                // 订单管理页面
                '.manage-page-head-title',
                '.ui-segmented-tablet-nav .nav-item',
                '.segmented-nav .text-ui',
                '.particulars-heading',
                '.order-timestamp-heading',
                '.badge.completed',
                '.badge.cancelled',
                '.u-tpg-slight-body',
                '.u-tpg-footnote',
                '.lo-grid-cell',
                // 标题和文本
                '.typography-16',

                '.text-center.font-bold',
                '.u-tpg-caption1',
                '.u-text-gray-500',
                '.lo-u-auto',

                // 表格相关
                'th.u-text-left',
                'th.u-text-right',
                'th.u-text-center',

                '.desktop\\:text-\\[18px\\]',
                '.desktop\\:leading-\\[28px\\]',
                '.mobile\\:typography-16',
                '.desktop\\:leading-\\[26px\\]',
                '.text-text-gray300',

                '.text-secondary800',
                '.cursor-pointer',
                '.flex.items-center',

                '.hero-headings__caption',
                '.hero-headings__link',
                '.description__app-name',
                '.description__app-caption',
                '.booth-app-description__name',
                '.booth-app-description__caption',
                '.regular-price__current',
                '.regular-price__unit',
                '.u-text-gray-300',
                '.u-my-0',

                // 标题相关
                '.u-tpg-title3',
                '.u-tpg-title4',
                '.u-align-buttom',

                // 购买历史页面
                '.sc-egTteO',
                '.sc-eTNep',
                '.sc-iCKYoX',

                // React Aria 标签和输入框
                'label[id^="react-aria"]',
                'input[id^="react-aria"]',

                // React 组件选择器
                '.sc-jdHJyC',
                '.sc-dQmhJc',
                '.sc-bCvmcN',
                '.sc-cPtzYu',
                '.sc-ckdFjP',

                // 按钮和选项
                'div[value][data-key]',
                'button[aria-label]',
                'li[role="option"]',

                // 库页面相关
                '.text-text-default.typography-16',
                '.desktop\\:typography-20',
                '.nav-item',

                // 愿望单相关
                '.sc-beySbM',
                '.sc-guDLRT',
                '.desktop\\:absolute',
                '.sc-cmfmEs',
                '.sc-dxjsDj',
                '.sc-fYlTny',

                // Tailwind 类
                '.text-\\[14px\\]',
                '.text-anchor',
                '.font-bold',
                '.inline-flex',
                '.items-center',

                // 按钮和链接
                'a[role="button"]',
                'button[class*="focus:shadow-secondary-focus"]',

                // 愿望单创建页面
                '.typography-16.text-center',
                '.typography-14',
                '.typography-12',
                '.booth-dip-switch__label',
                '.text-text-gray500',

                // Tailwind 类
                '.bg-secondary600',
                '.font-bold',
                '.rounded-\\[20px\\]',
                '.text-white',
                '.hover\\:opacity-80',

                // 表单元素
                'label.typography-14',
                'button[type="submit"]',
                'input[type="text"]',
                'textarea',

                // 已有的 badge 选择器
                '.badge',
                '.notice',
                '.announcement_type',

                // 店铺设计页面
                '.font-bold.py-4.typography-14',  // 标题
                '.typography-14',                 // 普通文本
                'label.font-normal',             // 标签文本
                'select option',                 // 下拉选项
                'button.sc-beySbM',              // 按钮
                '.text-text-default',            // 默认文本
                'ul.text-text-gray500 li',       // 提示列表
                '.unfollow-action',
                'li.u-tpg-caption2',  // 专门针对列表项
                '.u-tpg-caption2',    // 保持原有的选择器

                '.u-tpg-title3.font-bold',           // 标题
                '.btn--small span',                   // 按钮内的文本 
                '.u-tpg-footnote.text-text-gray300',  // 提示文本
                '.mobile\\:w-full span',              // 移动端按钮文本
                'button.btn span',                    // 按钮内的span文本
                'div.u-mb-300 .u-tpg-title3',        // 带有特定父元素的标题

                '.js-sp-search-trigger',  // 搜索触发器
                '.font-bold.absolute.right-0',  // 右侧绝对定位的粗体文本

                // 订单详情页面相关
                '.typography-16.desktop\\:mb-16',
                '.typography-16.preserve-half-leading',
                '.desktop\\:typography-16',
                '.mobile\\:typography-14',
                '.text-primary500',
                '.font-bold.typography-16',
                '.font-bold.text-right',
                '.preserve-half-leading',

                // 价格和费用相关
                '.flex-grow',
                '.text-right',
                '.font-bold.preserve-half-leading',

            ],
            // 动态内容选择器
            dynamic: [
                // 图标和提示文本
                'i.icon-download',
                'i.s-1x[title]',
                // 按钮和交互元素
                '.follow-button',
                '.follow-action',
                '.follow-action .u-align-middle',
                '.unfollow-action .u-align-middle',
                '.like-button',
                '.cart-button',

                // 筛选按钮
                '.js-search-filter-button .text-sm',
                // 消息通知
                '.activity-body b',  // 消息通知文本
                '.activity-items .activity-item',  // 消息列表项
                // 输入框
                '.item-search-box input[type="text"]',  // 搜索框容器内的输入框
                '.item-search-input__container input',  // 搜索框组件内的输入框
                'input[type="text"]',
                'input[type="search"]',
                'input[placeholder]',
                'input[type="submit"]',
                'textarea',
                // 订单管理动态内容
                '.nav-item span',
                '.cmd-label',
                '.link-ext',
                '.text-secondary800 .cursor-pointer',

                // BOOTH Apps 动态内容
                '.nav-reverse span',
                '.booth-app-description__caption',

                // 动态按钮和输入框
                'button[type="button"] span',
                'input[type="text"]',

                // 动态文本
                '.sc-dxjsDj span',
                'a[role="button"] span',

                // 动态表单元素
                'input[placeholder]',
                '.nav-reverse span',
                'input[type="search"]',

                // 订单详情动态内容
                '.flex.items-center div',
                '.font-bold.text-primary500',
                '.flex.flex-row div',
            ],
            // 排除的选择器
            exclude: [
                '.booth-description',  // 商品描述
                '.description',        // 描述区域
                '.item-search-input__suggestions_container',  // 搜索建议容器
                '.booth-text-field',
                '.tag-text',
                '.dashboard-items-variation-label',
                '.js-item-tags-array',
                '.share-btns__share-btn',
                'div.flex-1 > div.u-tpg-caption1.u-text-gray-500',  // 使用父子关系选择器
                '.flex-1 > .u-tpg-caption1.u-text-gray-500',        // 备用选择器
                '.slick-slide',
                '.share-btns',
                '.react-autowhatever-1',
            ],
            // 需要翻译的属性
            attributes: {
                translate: ['placeholder', 'aria-label', 'title', 'data-text', 'value'],  // 添加 value 属性
                observe: ['class', 'data-state']
            }
        };

        // 获取所有选择器
        static getAllSelectors() {
            return [
                ...this.selectors.static,
                ...this.selectors.dynamic
            ];
        }

        // 获取需要观察的属性
        static getObserveAttributes() {
            return [
                ...this.selectors.attributes.translate,
                ...this.selectors.attributes.observe
            ];
        }
    }

    // 翻译器类 - 处理文本翻译
    class Translator {
        // 处理特殊规则
        static applySpecialRule(text, rule) {
            let result = text;
            if (rule) {
                if (rule.prepend) {
                    result = rule.prepend + result;
                }
                if (rule.append) {
                    result = result + rule.append;
                }
            }
            return result;
        }

        static translate(text, element) {
            if (!text || typeof text !== 'string') return text;
            let result = text;

            // 获取特殊规则
            let currentRule = null;
            for (const [selector, rule] of Object.entries(Config.specialRules)) {
                if (element && element.matches(selector)) {
                    currentRule = rule;
                    break;
                }
            }

            // 按源文本长度降序排序翻译规则,确保优先匹配较长的文本
            const sortedTranslations = Object.entries(Config.translations)
                .sort((a, b) => b[0].length - a[0].length);

            // 遍历所有翻译规则进行替换
            for (const [source, target] of sortedTranslations) {
                if (result.includes(source)) {
                    // 转义正则表达式特殊字符
                    const escapedSource = source.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                    // 创建全局替换的正则表达式
                    const regex = new RegExp(escapedSource, 'g');
                    // 替换并应用特殊规则
                    let replacement = target;
                    if (currentRule) {
                        if (currentRule.prepend) {
                            replacement = currentRule.prepend + replacement;
                        }
                        if (currentRule.append) {
                            replacement = replacement + currentRule.append;
                        }
                    }
                    result = result.replace(regex, replacement);
                }
            }

            return result;
        }

        static translateNode(node) {
            if (node.nodeType === Node.TEXT_NODE) {
                return this.translateTextNode(node);
            }
            if (node.nodeType === Node.ELEMENT_NODE) {
                return this.translateElement(node);
            }
        }

        static translateTextNode(node) {
            const text = node.textContent.trim();
            if (!text) return;

            // 传入节点的父元素以检查特殊规则
            const translated = this.translate(text, node.parentElement);
            if (translated !== text) {
                node.textContent = node.textContent.replace(text, translated);
            }
        }

        static translateElement(element) {
            let hasTranslation = false;

            // 翻译属性
            Config.selectors.attributes.translate.forEach(attr => {
                if (element.hasAttribute(attr)) {
                    const value = element.getAttribute(attr);
                    if (value) {  // 确保属性值存在
                        const translated = this.translate(value, element);
                        if (translated !== value) {
                            element.setAttribute(attr, translated);
                            // 为每个翻译过的属性添加标记
                            element.setAttribute(`data-translated-${attr}`, 'true');
                            hasTranslation = true;
                        }
                    }
                }
            });

            // 检查是否在排除列表中
            const isExcluded = Config.selectors.exclude.some(selector => {
                return element.matches(selector) || element.closest(selector);
            });

            // 如果不在排除列表中，或者有特殊属性需要翻译
            if (!isExcluded || element.hasAttribute('title') || element.hasAttribute('placeholder')) {
                // 翻译子节点
                element.childNodes.forEach(node => {
                    if (Utils.shouldTranslate(node)) {
                        const text = node.textContent?.trim();
                        if (text) {
                            const translated = this.translate(text, element);
                            if (translated !== text) {
                                if (node.nodeType === Node.TEXT_NODE) {
                                    node.textContent = node.textContent.replace(text, translated);
                                } else {
                                    this.translateNode(node);
                                }
                                hasTranslation = true;  // 标记已进行翻译
                            }
                        }
                    }
                });
            }

            // 只有在实际进行了翻译时才标记元素
            if (hasTranslation) {
                element.setAttribute('data-translated', 'true');
            }
        }
    }

    // 工具类 - 提供通用功能
    class Utils {
        // 节流函数 - 限制函数调用频率
        static throttle(func, limit) {
            let inThrottle;
            return function (...args) {
                if (!inThrottle) {
                    func.apply(this, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            };
        }

        // 检查元素是否需要翻译
        static shouldTranslate(element) {
            // 检查是否在排除列表中
            const isExcluded = (el) => {
                if (!el || !el.matches) return false;
                return Config.selectors.exclude.some(selector => {
                    return el.matches(selector) || el.closest(selector);
                });
            };

            // 跳过空文本节点
            if (element.nodeType === Node.TEXT_NODE) {
                const parent = element.parentElement;
                // 检查父元素是否在排除列表中
                if (!parent || isExcluded(parent)) {
                    return false;
                }
                return element.textContent.trim() !== '';
            }

            // 以下检查仅适用于元素节点
            if (element.nodeType === Node.ELEMENT_NODE) {
                // 跳过脚本和样式标签
                if (element.tagName === 'SCRIPT' || element.tagName === 'STYLE') {
                    return false;
                }
                // 如果元素在排除列表中，但有title或placeholder属性，仍然允许翻译
                if (isExcluded(element)) {
                    return element.hasAttribute('title') || element.hasAttribute('placeholder');
                }
                // 即使已翻译，也允许继续模糊匹配
                if (element.hasAttribute('data-translated')) {
                    return element.textContent.trim() !== '';
                }
            }

            return true;
        }
    }

    // 观察器类 - 处理DOM变化
    class Observer {
        constructor() {
            this.throttledHandle = Utils.throttle(this.handleMutations.bind(this), Config.settings.throttleDelay);
            this.observer = new MutationObserver(this.throttledHandle);
            this.processing = false;
            this.checkInterval = null;
        }

        start() {
            // 监听整个文档的变化
            this.observer.observe(document.body, {
                childList: true,
                subtree: true,
                attributes: true,
                attributeFilter: Config.getObserveAttributes(),
                characterData: true,
                attributeOldValue: true
            });

            // 启动定期检查
            this.startPeriodicCheck();
        }

        startPeriodicCheck() {
            this.checkInterval = setInterval(() => {
                this.checkUntranslatedElements();
            }, Config.settings.checkInterval);
        }

        checkUntranslatedElements() {
            let untranslatedCount = 0;

            // 检查所有动态内容
            Config.selectors.dynamic.forEach(selector => {
                try {
                    document.querySelectorAll(`${selector}:not([data-translated])`).forEach(element => {
                        if (Utils.shouldTranslate(element)) {
                            Translator.translateElement(element);
                            untranslatedCount++;
                        }
                    });
                } catch (error) {
                    console.error(`选择器 ${selector} 查询失败:`, error);
                }
            });

            // 检查特定属性
            Config.selectors.attributes.translate.forEach(attr => {
                try {
                    document.querySelectorAll(`[${attr}]:not([data-translated-${attr}])`).forEach(element => {
                        if (Utils.shouldTranslate(element)) {
                            Translator.translateElement(element);
                            untranslatedCount++;
                        }
                    });
                } catch (error) {
                    console.error(`属性 ${attr} 查询失败:`, error);
                }
            });

            return untranslatedCount;
        }

        handleMutations(mutations) {
            if (this.processing) return;
            this.processing = true;

            try {
                const changedElements = new Set();

                mutations.forEach(mutation => {
                    if (mutation.type === 'childList') {
                        mutation.addedNodes.forEach(node => {
                            if (Utils.shouldTranslate(node)) {
                                changedElements.add(node);
                            }
                        });

                        if (mutation.removedNodes.length > 0 && mutation.target) {
                            changedElements.add(mutation.target);
                        }
                    }
                    else if (mutation.type === 'attributes') {
                        const target = mutation.target;
                        if (Utils.shouldTranslate(target)) {
                            changedElements.add(target);
                        }
                    }
                    else if (mutation.type === 'characterData') {
                        const target = mutation.target;
                        if (Utils.shouldTranslate(target)) {
                            changedElements.add(target);
                        }
                    }
                });

                changedElements.forEach(element => {
                    Translator.translateNode(element);
                });
            } catch (error) {
                console.error('处理DOM变化时出错:', error);
            } finally {
                this.processing = false;
            }
        }

        stopPeriodicCheck() {
            if (this.checkInterval) {
                clearInterval(this.checkInterval);
                this.checkInterval = null;
            }
        }

        disconnect() {
            this.observer.disconnect();
            this.stopPeriodicCheck();
        }
    }

    // 主应用类 - 协调整体功能
    class TranslatorApp {
        constructor() {
            this.observer = new Observer();
            this.initialized = false;
        }

        // 等待语言选择器加载
        async waitForLanguageSelector(maxAttempts = 10, interval = 500) {
            for (let i = 0; i < maxAttempts; i++) {
                const languageSwitcher = document.querySelector('.js-locale-switcher');
                const currentLanguage = languageSwitcher?.querySelector('.bg-ui-background200');

                if (currentLanguage) {
                    const text = currentLanguage.textContent.trim();
                    console.log('检测到的语言:', text);
                    return text.includes('简体中文');
                }

                console.log(`等待语言选择器加载... (${i + 1}/${maxAttempts})`);
                await new Promise(resolve => setTimeout(resolve, interval));
            }

            console.log('语言选择器加载超时');
            return false;
        }

        async start() {
            try {
                // 等待DOM加载完成
                if (document.readyState === 'loading') {
                    await new Promise(resolve => document.addEventListener('DOMContentLoaded', resolve));
                }

                // 等待语言选择器加载并检查语言设置
                const isChineseUI = await this.waitForLanguageSelector();
                if (!isChineseUI) {
                    console.log('当前不是简体中文界面，翻译助手未启动');
                    return;
                }

                // 初始化翻译
                this.translateAll();

                // 启动观察器
                this.observer.start();

                this.initialized = true;
                console.log('Booth翻译助手已启动');
            } catch (error) {
                console.error('Booth翻译助手启动失败:', error);
                this.handleError(error);
            }
        }

        stop() {
            if (this.observer) {
                this.observer.disconnect();
            }
            this.initialized = false;
            console.log('Booth翻译助手已停止');
        }

        restart() {
            this.stop();
            this.start();
        }

        translateAll() {
            try {
                const allSelectors = Config.getAllSelectors();
                const batchSize = 10; // 减小批次大小到10个

                for (let i = 0; i < allSelectors.length; i += batchSize) {
                    const batchSelectors = allSelectors.slice(i, i + batchSize);

                    // 单独处理每个选择器
                    batchSelectors.forEach(selector => {
                        try {
                            const elements = document.querySelectorAll(selector);
                            elements.forEach(element => {
                                if (Utils.shouldTranslate(element)) {
                                    Translator.translateNode(element);
                                }
                            });
                        } catch (error) {
                            console.error(`选择器 "${selector}" 处理失败:`, error);
                        }
                    });
                }
            } catch (error) {
                console.error('翻译过程中发生错误:', error);
                this.handleError(error);
            }
        }

        handleError(error) {
            // 记录错误
            console.error('Booth翻译助手错误:', error);

            // 如果是致命错误，尝试重启
            if (error instanceof TypeError || error instanceof ReferenceError) {
                console.log('检测到致命错误，尝试重启...');
                setTimeout(() => this.restart(), 1000);
            }
        }
    }

    // 启动应用
    const app = new TranslatorApp();
    app.start();
})(); 